knitr::opts_chunk$set(echo = TRUE)
df = read.csv('data/data_clean.csv')
df$size = as.factor(df$size)
df$python = as.factor(df$python)
df$visual_software = as.factor(df$visual_software)
df$ML_software = as.factor(df$ML_software)
df$spark = as.factor(df$spark)
df$aws = as.factor(df$aws)
df$excel = as.factor(df$excel)
df$sql = as.factor(df$sql)
df$sas = as.factor(df$sas)
df$hadoop = as.factor(df$hadoop)
df$degree = as.factor(df$degree)
df$in_CA = as.factor(df$in_CA)
df$senior_status = as.factor(df$senior_status)
df = df[-4]
df
#interaction
fit2 = lm(avg_salary_k~(.)^2, data=df)
par(mfrow=c(2, 2))
plot(fit2)
library(MASS)
library(caret)
library(leaps)
# run stepwise AIC
fit0 = lm(avg_salary_k~1, data=df)
stepAIC(fit0, scope=list(upper=fit2, lower=fit1), direction='both')
# run stepwise AIC
fit0 = lm(avg_salary_k~1, data=df)
stepAIC(fit0, scope=list(upper=fit2, lower=fit0), direction='both')
# run stepwise AIC
fit0 = lm(avg_salary_k~1, data=df)
stepAIC(fit0, scope=list(upper=fit2, lower=fit0), direction='both', trace=F)
# run stepwise AIC
fit0 = lm(avg_salary_k~1, data=df)
step.aic = stepAIC(fit0, scope=list(upper=fit2, lower=fit0), direction='both', trace=FALSE)
step.aic$anova
# fit final model
fit3 = lm(avg_salary_k ~ senior_status + in_CA + python + degree + visual_software +
age + rating + sas + aws + ML_software + python:aws + age:sas +
in_CA:ML_software + age:ML_software)
# fit final model
fit3 = lm(avg_salary_k ~ senior_status + in_CA + python + degree + visual_software +
age + rating + sas + aws + ML_software + python:aws + age:sas +
in_CA:ML_software + age:ML_software, data=df)
summary(fit3)
anova(fit3)
par(mfrow=c(2, 2))
plot(fit3)
par(mfrow=c(2, 2))
plot(fit3)
pairs(df)
par(mfrow=c(2, 2))
plot(fit3)
par(mfrow=c(2, 2))
plot(fit3)
cor(df)
# linear
fit1 = lm(avg_salary_k~., data=df)
summary(fit1)
#interaction
fit2 = lm(avg_salary_k~(.)^2, data=df)
par(mfrow=c(2, 2))
plot(fit2)
# run stepwise AIC
fit0 = lm(avg_salary_k~1, data=df)
step.aic = stepAIC(fit0, scope=list(upper=fit1, lower=fit0), direction='both', trace=FALSE)
step.aic$anova
# fit final model
fit3 = lm(avg_salary_k ~ senior_status + in_CA + python + degree + visual_software +
age + rating + sas + aws + ML_software, data=df)
summary(fit3)
# fit final model
fit3 = lm(avg_salary_k ~ senior_status + in_CA + python + degree + visual_software +
age + rating + sas + aws + ML_software, data=df)
summary(fit3)
# model diagnostics
par(mfrow=c(2, 2))
plot(fit3)
libary(MASS)
library(MASS)
library(leaps)
# import data
df = read.csv('data/data_clean.csv')
View(df)
View(df)
# import data
df = read.csv('data/data_clean.csv')
# remove location column
df = df[-4]
View(df)
View(df)
# import data
df = read.csv('data/data_clean.csv')
# remove location column
df = df[-4]
df
# import data
df = read.csv('data/data_clean.csv')
# remove location column
df = df[-4]
df
# import data
df = read.csv('data/data_clean.csv')
# remove location column
df = df[-4]
df
# import data
df = read.csv('data/data_clean.csv')
# remove location column
df = df[-4]
df
# import data
df = read.csv('data/data_clean.csv')
# remove location column
df = df[-4]
df
# import data
df = read.csv('data/data_clean.csv')
# remove location column
df = df[-4]
df
model1 = lm(avg_salary_k~., data=df)
summary(model1)
433-411
# Model diagnostics
par(mfrow=c(2, 2))
plot(model1)
View(df)
# Second order interaction model
model2 = lm(avg_salary_k~(.)^2, data=df)
summary(model2)
433-222
library(MASS)
library(leaps)
# import data
df = read.csv('data/data_clean.csv')
# remove location column
df = df[-4]
df
# change categorical variables to R Factors
df$size = as.factor(df$size)
df$python = as.factor(df$python)
df$visual_software = as.factor(df$visual_software)
df$ML_software = as.factor(df$ML_software)
df$spark = as.factor(df$spark)
df$aws = as.factor(df$aws)
df$excel = as.factor(df$excel)
df$sql = as.factor(df$sql)
df$sas = as.factor(df$sas)
df$hadoop = as.factor(df$hadoop)
df$degree = as.factor(df$degree)
df$in_CA = as.factor(df$in_CA)
df$senior_status = as.factor(df$senior_status)
model1 = lm(avg_salary_k~., data=df)
summary(model1)
# Model diagnostics
par(mfrow=c(2, 2))
plot(model1)
# Second order interaction model
model2 = lm(avg_salary_k~(.)^2, data=df)
summary(model2)
fit0 = lm(avg_salary_k~1, data=df)
step.aic = stepAIC(fit0, scope=list(upper=model2, lower=fit0), trace=FALSE)
step.aic$anova
# fit selected model
model2_aic = lm(avg_salary_k ~ senior_status + in_CA + python + degree + visual_software +
age + rating + sas + aws + ML_software + python:aws + age:sas +
in_CA:ML_software + age:ML_software, data=df)
summary(model2_aic)
fit0 = lm(avg_salary_k~1, data=df)
step.aic = stepAIC(fit0, scope=list(upper=model1, lower=fit0), trace=FALSE)
step.aic$anova
# fit the selected model
model1_aic = lm(avg_salary_k ~ senior_status + in_CA + python + degree + visual_software +
age + rating + sas + aws + ML_software)
# fit the selected model
model1_aic = lm(avg_salary_k ~ senior_status + in_CA + python + degree + visual_software +
age + rating + sas + aws + ML_software, data=df)
summary(model1_aic)
0.3865-0.3658
0.3492 - 0.3552
# model diagnostics
par(mfrow=c(2, 2))
plot(model2_aic)
# model diagnostics
par(mfrow=c(2, 2))
plot(model1_aic)
hist(log(df$avg_salary_k))
hist(df$avg_salary_k)
hist(log(df$avg_salary_k))
boxcox(model1)
boxcox(model1, data=df)
hist(sqrt(df$avg_salary_k))
df_sqrtY = df
df_sqrtY$avg_salary_k = sqrt(df$avg_salary_k)
View(df_sqrtY)
View(df_sqrtY)
model1_sqrt = lm(avg_salary_k~., data=df_sqrtY)
summary(model1_sqrt)
1.441^2
29.35^2
# model diagnostics
par(mfrow=c(2, 2))
plot(model1_sqrt)
# model diagnostics
par(mfrow=c(2, 2))
plot(model1_sqrt)
